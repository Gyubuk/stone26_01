{% load static %}
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>구매 가정 상품 선택 - AuctionLab</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .fade-up  { animation: fadeUp 0.5s ease-out forwards; }
    .delay-1  { animation-delay: 0.05s; opacity: 0; }
    .delay-2  { animation-delay: 0.15s; opacity: 0; }
    .delay-3  { animation-delay: 0.25s; opacity: 0; }
    .delay-4  { animation-delay: 0.35s; opacity: 0; }
    .delay-5  { animation-delay: 0.45s; opacity: 0; }

    /* 입력 필드 */
    .field-input {
      width: 100%;
      border: 1.5px solid #e5e7eb;
      border-radius: 12px;
      padding: 14px 16px;
      font-size: 1rem;
      color: #111827;
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
      font-family: 'Noto Sans KR', sans-serif;
      background: white;
    }
    .field-input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37,99,235,0.12);
    }
    .field-input::placeholder { color: #9ca3af; }

    /* 이미지 플레이스홀더 */
    .img-placeholder {
      border: 1.5px solid #e5e7eb;
      border-radius: 12px;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      aspect-ratio: 16/9;
      color: #9ca3af;
    }

    /* 제출 버튼 */
    .btn-submit {
      transition: all 0.2s ease;
      background: #4f46e5;
      color: white;
      font-weight: 700;
      font-size: 1.05rem;
      border-radius: 14px;
      padding: 18px 0;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-submit:hover {
      background: #4338ca;
      transform: translateY(-1px);
      box-shadow: 0 8px 24px rgba(79,70,229,0.3);
    }
    .btn-submit:active { transform: translateY(0); }

    /* 스크롤바 */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
  </style>
</head>
<body class="min-h-screen bg-gray-50">

  <!-- 상단 헤더 -->
  <div class="bg-white border-b border-gray-200 py-4 px-6 flex items-center shadow-sm sticky top-0 z-10">
    <div class="flex items-center gap-2 text-gray-700 font-bold">
      <i class="fas fa-box text-gray-400 text-sm"></i>
      <span class="text-sm sm:text-base">온라인 경매 상황에서의 구매 의사결정 실험</span>
    </div>
    <div class="ml-2 text-xs text-gray-400 font-medium hidden sm:block">MRA Lab @ SSU</div>
  </div>

  <div class="max-w-2xl mx-auto px-4 py-10 pb-20">

    <!-- 페이지 타이틀 -->
    <h1 class="text-2xl font-black text-center text-gray-900 mb-8 tracking-tight fade-up delay-1">구매 가정 상품 선택 (가제)</h1>

    <!-- 에러 메시지 -->
    {% if error %}
    <div class="mb-6 bg-red-50 border border-red-200 text-red-700 rounded-2xl px-5 py-4 flex items-center gap-3">
      <i class="fas fa-exclamation-circle text-red-500 shrink-0"></i>
      <span class="font-medium text-sm">{{ error }}</span>
    </div>
    {% endif %}

    <!-- 실험 개요 카드 -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-6 fade-up delay-1">
      <div class="bg-gray-50/50 px-8 py-5 border-b border-gray-100">
        <div class="font-bold text-xl text-gray-900">실험 개요</div>
      </div>
      <div class="px-8 py-7">
        <ul class="space-y-4 text-gray-700 text-sm leading-relaxed">
          <li class="flex items-start gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-gray-500 shrink-0 mt-2"></span>
            <div>
              <span class="font-bold text-gray-900">실험 기본 조건 및 규칙</span>
              <ul class="mt-2 space-y-2 pl-1">
                <li class="flex items-start gap-2">
                  <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                  본 실험은 수수료 수준에 따른 구매자의 전략적 의사결정 변화를 분석하기 위해 설계되었습니다.
                </li>
                <li class="flex items-start gap-2">
                  <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                  참가자는 약 10~20만 원대 상품의 구매 상황을 가정한 뒤 온라인 거래 환경에 참여합니다.
                </li>
                <li class="flex items-start gap-2">
                  <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                  실험은 수수료 수준에 따라 3가지 타입(3,000원 / 6,000원 / 9,000원)으로 구성되며, 각 타입별로 14회 반복 실험이 진행됩니다.
                </li>
                <li class="flex items-start gap-2">
                  <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                  하나의 타입에 대한 1회 실험은 총 5라운드로 구성되며, 실험 참가자는 각 라운드에서 즉시 구매 또는 입찰 참여 중 하나를 선택하게 됩니다. 또한 5라운드 이내에 반드시 한 번 이상 구매가 이루어져야 합니다.
                </li>
                <li class="flex items-start gap-2">
                  <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                  본 실험에 앞서 참가자가 실험 구조를 이해할 수 있도록 아래에 0라운드(연습 게임)를 별도로 운영하려 합니다.
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <form method="post">
      {% csrf_token %}

      <!-- 1. 위험 성향 측정 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-6 fade-up delay-2">
        <div class="bg-gray-50/50 px-8 py-5 border-b border-gray-100 flex justify-between items-center">
          <div class="font-bold text-xl text-gray-900">1. 위험 성향 측정</div>
          <span class="text-red-500 font-bold text-lg">*</span>
        </div>
        <div class="px-8 py-7">

          <!-- 설명 bullet -->
          <ul class="space-y-2 text-gray-700 text-sm leading-relaxed mb-7">
            <li class="flex items-start gap-2">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
              본 실험에서는 개인의 위험 성향 차이가 전략 선택에 미치는 영향을 분석하기 위해, 실험 시작 전 간단한 확률 기반 문항을 통해 위험 성향을 측정합니다.
            </li>
            <li class="flex items-start gap-2">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
              해당 문항은 개인의 위험 선호 경향을 파악하기 위한 참고 자료이며, 이후 실험에서 나타나는 즉시 구매 또는 입찰 선택 패턴과 비교 분석에 활용됩니다.
            </li>
            <li class="flex items-start gap-2">
              <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
              위험 성향 측정 결과는 연구 목적에 한해 익명으로 사용됩니다.
            </li>
          </ul>

          <!-- 복권 질문 박스 -->
          <div class="bg-gray-50 border border-gray-200 rounded-xl p-6 flex flex-col sm:flex-row gap-5 items-start">
            <!-- 티켓 아이콘 -->
            <div class="bg-blue-100 rounded-full p-4 flex items-center justify-center shrink-0 self-start">
              <i class="fas fa-ticket-alt text-blue-500 text-2xl"></i>
            </div>
            <div class="flex-1 w-full">
              <p class="text-gray-900 font-medium mb-4 leading-relaxed text-sm">
                당첨 시 상금 1억 원, 당첨 확률 30%인 복권이 있습니다. 이 복권을 최대 얼마까지 지불하고 구매하시겠습니까?
              </p>
              <!-- ₩ 입력 -->
              <div class="flex items-center bg-white border border-gray-300 rounded-xl px-4 py-3 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all">
                <span class="text-gray-700 font-bold mr-2 text-base">₩</span>
                <input type="text" name="expected_price" id="riskInput"
                       class="flex-1 outline-none text-gray-900 placeholder-gray-400 text-sm bg-transparent"
                       placeholder="금액 입력 (예: 30,000,000)"
                       oninput="formatRisk(this)" required>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- 실험 시나리오 카드 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-6 fade-up delay-3">
        <div class="bg-gray-50/50 px-8 py-5 border-b border-gray-100">
          <div class="font-bold text-xl text-gray-900">실험 시나리오</div>
        </div>
        <div class="px-8 py-7 space-y-8">

          <!-- Step 1 -->
          <div>
            <h3 class="font-bold text-base text-center text-gray-900 mb-4">Step 1. 판매 희망 가격 확인</h3>
            <div class="img-placeholder mb-4">
              <i class="fas fa-image text-3xl"></i>
            </div>
            <p class="text-sm text-gray-700 leading-relaxed">
              실험에 참여하게 되면, 화면에 판매자가 설정한 판매 희망 가격인 즉시 구매 가격이 제시됩니다. 참가자는 해당 가격을 확인한 후, 다음 두 가지 선택지 중 하나를 반드시 결정해야 합니다.
            </p>
            <ul class="mt-3 space-y-1 text-sm text-gray-700">
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0"></span>
                Option 1. 즉시 구매
              </li>
              <li class="flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0"></span>
                Option 2. 경매 입찰 참여
              </li>
            </ul>
          </div>

          <!-- Step 2 -->
          <div>
            <h3 class="font-bold text-base text-center text-gray-900 mb-4">Step 2. 구매 방법</h3>
            <div class="img-placeholder mb-4">
              <i class="fas fa-image text-3xl"></i>
            </div>
            <p class="text-sm text-gray-700 leading-relaxed font-bold mb-2">Option 1: 즉시 구매</p>
            <ul class="text-sm text-gray-700 leading-relaxed space-y-1">
              <li class="flex items-start gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                참가자가 즉시 구매를 선택할 경우, 제시된 가격으로 해당 라운드에서 즉시 거래가 체결되며, 해당 회차는 종료됩니다.
              </li>
            </ul>
          </div>

          <!-- Step 3 -->
          <div>
            <h3 class="font-bold text-base text-center text-gray-900 mb-4">Step 3. 입찰 결과 확인</h3>
            <div class="img-placeholder mb-4">
              <i class="fas fa-image text-3xl"></i>
            </div>
            <p class="text-sm text-gray-700 leading-relaxed font-bold mb-2">Option 2: 경매 입찰</p>
            <ul class="text-sm text-gray-700 leading-relaxed space-y-1.5">
              <li class="flex items-start gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                참가자가 입찰을 선택할 경우, 원하는 입찰 가격을 직접 입력해야 합니다.
              </li>
              <li class="flex items-start gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gray-400 shrink-0 mt-1.5"></span>
                입찰 가격 입력 후, 판매자의 거래 조건에 따라 해당 가격이 낙찰(거래 체결) / 유찰(거래 실패)로 결정됩니다.
                <ul class="mt-1.5 space-y-1 pl-3">
                  <li class="flex items-start gap-2">
                    <span class="w-1.5 h-1.5 rounded-full bg-gray-300 shrink-0 mt-1.5"></span>
                    입력한 가격이 판매자의 판매 기준을 충족할 경우 =&gt; 낙찰
                  </li>
                  <li class="flex items-start gap-2">
                    <span class="w-1.5 h-1.5 rounded-full bg-gray-300 shrink-0 mt-1.5"></span>
                    기준을 충족하지 못할 경우 =&gt; 유찰
                  </li>
                </ul>
              </li>
            </ul>
            <p class="text-xs text-gray-400 mt-3">*판매자의 판매 기준은 화면에서 확인 불가능합니다.</p>
          </div>

        </div>
      </div>

      <!-- 구매 희망 상품 입력 카드 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-6 fade-up delay-4">
        <div class="bg-gray-50/50 px-8 py-5 border-b border-gray-100">
          <div class="font-bold text-xl text-gray-900">구매 희망 상품 입력</div>
        </div>
        <div class="px-8 py-7">
          <p class="text-gray-700 text-sm leading-relaxed mb-5">
            본 실험은 특정 브랜드나 제품에 대한 선호를 분석하는 것이 아니라, 가격 조건에 따른 의사결정 과정을 분석하는 것을 목적으로 합니다.<br>
            약 10~20만 원 내외의 가격대로 구매를 상상할 수 있는 상품을 자유롭게 적어주세요.
          </p>
          <label class="block text-sm font-bold text-gray-800 mb-3">
            상품명 (예: 신발, 전자기기 액세서리, 의류 등)
          </label>
          <input type="text" name="product" required maxlength="200"
                 placeholder="상품명을 입력해주세요"
                 class="field-input">
        </div>
      </div>

      <!-- 제출 버튼 -->
      <div class="fade-up delay-5">
        <button type="submit" class="btn-submit">
          실험 시작하기
          <i class="fas fa-chevron-right text-sm"></i>
        </button>
      </div>

    </form>
  </div>

  <script>
    function formatRisk(input) {
      const raw = input.value.replace(/[^0-9]/g, '');
      input.value = raw ? Number(raw).toLocaleString() : '';
      // hidden field에 숫자만 저장
      let hidden = document.getElementById('riskRaw');
      if (!hidden) {
        hidden = document.createElement('input');
        hidden.type = 'hidden';
        hidden.id = 'riskRaw';
        hidden.name = 'expected_price_raw';
        input.parentElement.appendChild(hidden);
      }
      hidden.value = raw;
    }
  </script>

</body>
</html>